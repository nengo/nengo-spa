
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Introduction to Nengo SPA &#8212; Nengo SPA 1.1.0 docs</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:400,400i,600|Rajdhani:700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
<link rel="stylesheet" href="https://www.nengo.ai/css/bootstrap.css" type="text/css">
<style>
  body .title-bar,
  body .documentation-source h1:after {
    background-color: #d40000;
  }
</style>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GT8XEDLTMJ"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());
 gtag('config', 'G-GT8XEDLTMJ');
</script>
<!-- End Google tag (gtag.js) -->

<!-- Matomo -->
<script>
 var _paq = window._paq = window._paq || [];
 _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
 _paq.push(["setCookieDomain", "*.appliedbrainresearch.com"]);
 _paq.push(["setDomains", ["*.appliedbrainresearch.com","*.edge.nengo.ai","*.forum.nengo.ai","*.labs.nengo.ai","*.nengo.ai"]]);
 _paq.push(["enableCrossDomainLinking"]);
 _paq.push(["setDoNotTrack", true]);
 _paq.push(['trackPageView']);
 _paq.push(['enableLinkTracking']);
 (function() {
   var u="https://appliedbrainresearch.matomo.cloud/";
   _paq.push(['setTrackerUrl', u+'matomo.php']);
   _paq.push(['setSiteId', '3']);
   var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
   g.async=true; g.src='//cdn.matomo.cloud/appliedbrainresearch.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
 })();
</script>
<!-- End Matomo Code -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://unpkg.com/scrollreveal"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stickyfill/2.1.0/stickyfill.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
<!-- From basic/layout.html -->
<script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
  
  
<script src="../_static/underscore.js"></script>
  
  
<script src="../_static/doctools.js"></script>
  
  
<script src="../_static/language_data.js"></script>
  
  
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
  
  
<script async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
  
<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Transitioning to nengo_spa coming from the core Nengo legacy SPA implementation" href="intro-coming-from-legacy-spa.html" />
    <link rel="prev" title="Introduction to the Semantic Pointer Architecture" href="../user-guide/spa-intro.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  </head><body class="bg-dark">

<header class="fixed-top header-top shadow-sm">
  <nav class="navbar navbar-expand-md navbar-light bg-white">
    <a class="navbar-brand" href="https://www.nengo.ai/">
      <img
        src="https://www.nengo.ai/design/_images/general-full-light.svg"
        alt="Nengo"
        class="logo"
      />
    </a>
    <button
      class="navbar-toggler"
      type="button"
      data-toggle="collapse"
      data-target="#navbar-collapse"
      aria-controls="navbar-collapse"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar-collapse">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="https://www.nengo.ai/">What is Nengo?</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://www.nengo.ai/examples/">Examples</a>
        </li>
        <li class="nav-item dropdown active">
          <a
            class="nav-link dropdown-toggle"
            id="navbar-dropdown-docs"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
            href="#"
            >Documentation</a
          >
          <div
            class="dropdown-menu shadow-lg border-0"
            aria-labelledby="navbar-dropdown-docs"
          >
            
            <a class="dropdown-item" href="https://www.nengo.ai/nengo/">Nengo Core</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-gui/">Nengo GUI</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-dl/">Nengo DL</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-spa/">Nengo SPA</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-extras/">Nengo Extras</a>
            <a class="dropdown-item" href="https://arvoelke.github.io/nengolib-docs/">Nengolib</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-fpga/">Nengo FPGA</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-loihi/">Nengo Loihi</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-ocl">Nengo OpenCL</a>
            <a class="dropdown-item" href="https://github.com/project-rig/nengo_spinnaker">Nengo SpiNNaker</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-mpi">Nengo MPI</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/documentation/"
              >All documentation</a
            >
          </div>
        </li>
        <li class="nav-item dropdown">
          <a
            class="nav-link dropdown-toggle"
            id="navbar-dropdown-community"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
            href="#"
            >Community</a
          >
          <div
            class="dropdown-menu shadow-lg border-0"
            aria-labelledby="navbar-dropdown-community"
          >
            <a class="dropdown-item" href="https://forum.nengo.ai">Forum</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/people/"
              >People</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/summer-school/"
              >Summer school</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/contributing/"
              >Contributing</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/publications/"
              >Publications</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/videos/"
              >Videos</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/conduct/"
              >Code of conduct</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/caa/">CAA</a>
          </div>
        </li>
        <li class="nav-item">
          <a
            class="nav-link btn btn-success btn-sm text-white"
            href="https://www.nengo.ai/getting-started/"
            >Getting started</a
          >
        </li>
      </ul>
    </div>
  </nav>
</header>
<div class="main-content gradient-top">
  <div class="container-fluid">
    <div class="row"><a class="toggle-sidenav d-block d-md-none" href="#"
  ><i class="icon-close fa fa-fw fa-arrow-left"></i
  ><i class="icon-open fa fa-fw fa-arrow-right"></i
></a>
<div role="complementary" class="sidenav col-4 col-xl-3 p-0 border-right">
  <h3 class="pt-5 px-5">
    <a href="../index.html">
      <img
        class="img-fluid documentation-image"
        src="https://www.nengo.ai/design/_images/nengo-spa-full-light.svg"
        alt="Nengo SPA"
      />
    </a>
  </h3>
<form class="px-5 py-3 my-0 border-bottom" action="../search.html" method="get">
  <div class="form-group form-group-single">
    <input type="text" name="q" class="form-control" placeholder="Search" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <button type="submit" class="btn btn-link">
      <img src="https://www.nengo.ai/img/icon-search.svg" alt="Go" />
    </button>
  </div>
</form><div class="p-5 toctree">
  
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../user-guide.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../user-guide/spa-intro.html">Introduction to the Semantic Pointer Architecture</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Introduction to Nengo SPA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Hello-world">Hello world</a></li>
<li class="toctree-l3"><a class="reference internal" href="#SPA-syntax">SPA syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Using-Transcode-for-computation">Using Transcode for computation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Using-the-config-system-with-Nengo-SPA">Using the config system with Nengo SPA</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Vocabularies">Vocabularies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Clean-up-memories">Clean up memories</a></li>
<li class="toctree-l3"><a class="reference internal" href="#What-is-next?">What is next?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="intro-coming-from-legacy-spa.html">Transitioning to <code class="docutils literal notranslate"><span class="pre">nengo_spa</span></code> coming from the core Nengo legacy SPA implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="custom-module.html">Implementing a custom module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user-guide/algebras.html">Algebras</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developer Guide</a></li>
</ul>

  
  </div>
  
  <form class="p-5 my-0 border-top">
    <div class="form-group">
      <label class="text-gray">Version:</label>
      <select class="custom-select" onchange="switchVersion(this);">
        
        
        <option value="../../examples/intro.html">latest</option>
        
        
          
        <option selected>v1.1.0</option>
          
        
      </select>
    </div>
  </form>
  
</div>
      

      <div class="col-12 col-md-8 col-xl-9">
        <div class="container">
          <div class="row">
            <div class="col-10 offset-1 pb-5 documentation-source" role="main">
              
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Introduction-to-Nengo-SPA">
<h1>Introduction to Nengo SPA<a class="headerlink" href="#Introduction-to-Nengo-SPA" title="Permalink to this headline">¶</a></h1>
<p>This tutorial introduces the usage of Nengo SPA. It expects some basic familarity with <a class="reference external" href="https://www.nengo.ai/nengo/">Nengo</a>. If you have used the legacy SPA implementation shipped with core Nengo, you might want to read <a class="reference internal" href="intro-coming-from-legacy-spa.html"><span class="doc">this alternate introduction</span></a>.</p>
<p>We recommend to <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">nengo_spa</span> <span class="pre">as</span> <span class="pre">spa</span></code>. (Note that this uses an underscore in the module name and is different from <code class="docutils literal notranslate"><span class="pre">nengo.spa</span></code> which refers to the legacy SPA module shipped with core Nengo.)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">nengo</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">nengo_spa</span> <span class="k">as</span> <span class="nn">spa</span>

<span class="n">seed</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We will have to specify the dimensionality of the Semantic Pointers. To make it easy to change in all places, we define the variable <em>d</em> here and set it to 32. A dimensionality of 32 is on the lower end (in most actual models you will want to use at least 64 dimensions and we have been using up to 512 dimensions), but it makes the examples in this introduction run faster.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">32</span>
</pre></div>
</div>
</div>
<div class="section" id="Hello-world">
<h2>Hello world<a class="headerlink" href="#Hello-world" title="Permalink to this headline">¶</a></h2>
<p>Let us start with a very simple model to demonstrate the basic usage of Nengo SPA:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">stimulus</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Transcode</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="n">output_vocab</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
    <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">stimulus</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The first thing to notice is that instead of <code class="docutils literal notranslate"><span class="pre">nengo.Network</span></code>, we use <code class="docutils literal notranslate"><span class="pre">spa.Network</span></code> here. This allows use to more easily use Nengo’s config system for Nengo SPA (something we will look at in more detail later). Then we instantiate two networks <code class="docutils literal notranslate"><span class="pre">spa.Transcode</span></code> and <code class="docutils literal notranslate"><span class="pre">spa.State</span></code>. These networks are aware of Semantic Pointer inputs and/or outputs. Such networks we also call (SPA) modules. The <code class="docutils literal notranslate"><span class="pre">Transcode</span></code> module is similar to a <code class="docutils literal notranslate"><span class="pre">nengo.Node</span></code>. Here it is given a the constant Semantic Pointer
<em>Hello</em> and it will output this pointer during the whole simulation. The <code class="docutils literal notranslate"><span class="pre">State</span></code> module is a network of Nengo ensembles that is optimized for representing (unit-length) Semantic Pointers. Both of these modules have a <em>vocab</em>-like argument which is short for <em>vocabulary</em>. In the context of Nengo SPA a vocabulary is a set of Semantic Pointers with a certain dimensionality. Here we just use the default vocabulary with dimensionality <em>d</em>. The required Semantic Pointers (in this example <em>Hello</em>)
will be automatically added to that vocabulary.</p>
<p>Modules can be used like normal Nengo networks. Thus, we can create a connection from the output of <em>stimulus</em> to the input of <em>state</em> and then probe the output of <em>state</em>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now, let us plot the probed data:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_intro_9_0.png" src="../_images/examples_intro_9_0.png" />
</div>
</div>
<p>This plot displays the raw vector components of the represented Semantic Pointer and is not extremely helpful. A useful function to get a more informative plot is <code class="docutils literal notranslate"><span class="pre">spa.similarity</span></code>. It takes the probe data and a vocabulary as arguments, and returns the similarity of the data to each Semantic Pointer in the vocabulary. We can access the vocabulary with the <em>vocab</em> attribute of the <code class="docutils literal notranslate"><span class="pre">State</span></code> module.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">spa</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p</span><span class="p">],</span> <span class="n">state</span><span class="o">.</span><span class="n">vocab</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Similarity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_intro_11_0.png" src="../_images/examples_intro_11_0.png" />
</div>
</div>
<p>We see that input Pointer is successfully represented.</p>
</div>
<div class="section" id="SPA-syntax">
<h2>SPA syntax<a class="headerlink" href="#SPA-syntax" title="Permalink to this headline">¶</a></h2>
<p>One of the main features of <code class="docutils literal notranslate"><span class="pre">nengo_spa</span></code> is a special syntax that makes it easier to construct large SPA models. Let us demonstrate this with a slightly more complicated example where we take represent a scene by a Semantic Pointer <code class="docutils literal notranslate"><span class="pre">BLUE</span> <span class="pre">*</span> <span class="pre">CIRCLE</span> <span class="pre">+</span> <span class="pre">RED</span> <span class="pre">*</span> <span class="pre">SQUARE</span></code> (<code class="docutils literal notranslate"><span class="pre">*</span></code> denotes circular convolution here) and use another input to selectively retrieve the color of one of the objects.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">scene</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Transcode</span><span class="p">(</span><span class="s1">&#39;BLUE * CIRCLE + RED * SQUARE&#39;</span><span class="p">,</span> <span class="n">output_vocab</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Transcode</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="s1">&#39;CIRCLE&#39;</span> <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">0.25</span> <span class="k">else</span> <span class="s1">&#39;SQUARE&#39;</span><span class="p">,</span> <span class="n">output_vocab</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>

    <span class="n">scene</span> <span class="o">*</span> <span class="o">~</span><span class="n">query</span> <span class="o">&gt;&gt;</span> <span class="n">result</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We see that the <code class="docutils literal notranslate"><span class="pre">Transcode</span></code> object also accepts functions like a Nengo <code class="docutils literal notranslate"><span class="pre">Node</span></code>. But the really interesting line is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scene</span> <span class="o">*</span> <span class="o">~</span><span class="n">query</span> <span class="o">&gt;&gt;</span> <span class="n">result</span>
</pre></div>
</div>
<p>This line is all that is needed to construct a network inverting a circular convolution (<code class="docutils literal notranslate"><span class="pre">*</span></code> is the circular convolution, <code class="docutils literal notranslate"><span class="pre">~</span></code> inverts <code class="docutils literal notranslate"><span class="pre">query</span></code>), connect <code class="docutils literal notranslate"><span class="pre">scene</span></code> and <code class="docutils literal notranslate"><span class="pre">query</span></code> as inputs, and then connect the output to result (<code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code>).</p>
<p>If we run the model, we see that is successfully decodes <code class="docutils literal notranslate"><span class="pre">BLUE</span></code> and <code class="docutils literal notranslate"><span class="pre">RED</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">spa</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p</span><span class="p">],</span> <span class="n">result</span><span class="o">.</span><span class="n">vocab</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Similarity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_intro_17_0.png" src="../_images/examples_intro_17_0.png" />
</div>
</div>
<p>Besides circular convolution (<code class="docutils literal notranslate"><span class="pre">*</span></code>) and the approximate inverse (<code class="docutils literal notranslate"><span class="pre">~</span></code>), you can use <code class="docutils literal notranslate"><span class="pre">*</span></code> also to scale with vectors with a fixed scalar or multiply to scalars, <code class="docutils literal notranslate"><span class="pre">+</span></code> and <code class="docutils literal notranslate"><span class="pre">-</span></code> to add and subtract Semantic Pointers, and <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> to compute a dot product if you are using Python &gt;= 3.5. To compute a dot product with older python versions use the <code class="docutils literal notranslate"><span class="pre">spa.dot</span></code> function.</p>
<div class="section" id="Symbols">
<h3>Symbols<a class="headerlink" href="#Symbols" title="Permalink to this headline">¶</a></h3>
<p>So far we used the <code class="docutils literal notranslate"><span class="pre">Transcode</span></code> network to provide fixed inputs to the network. But there is a second method that sometimes means less typing.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Transcode</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="s1">&#39;CIRCLE&#39;</span> <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">0.25</span> <span class="k">else</span> <span class="s1">&#39;SQUARE&#39;</span><span class="p">,</span> <span class="n">output_vocab</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>

    <span class="p">((</span><span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">BLUE</span> <span class="o">*</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">CIRCLE</span> <span class="o">+</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">RED</span> <span class="o">*</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">SQUARE</span><span class="p">)</span> <span class="o">*</span> <span class="o">~</span><span class="n">query</span>
     <span class="o">&gt;&gt;</span> <span class="n">result</span><span class="p">)</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">spa.sym</span></code> object is a special object on which you can access arbitrary attributes that will magically return symbolic representations of Semantic Pointers that can be combined with the usual operators among each other or with SPA modules which will cause the required neural networks to be implemented.</p>
<p><code class="docutils literal notranslate"><span class="pre">spa.sym</span></code> can also be called as a function:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Transcode</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="s1">&#39;CIRCLE&#39;</span> <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">0.25</span> <span class="k">else</span> <span class="s1">&#39;SQUARE&#39;</span><span class="p">,</span> <span class="n">output_vocab</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>

    <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="p">(</span><span class="s1">&#39;BLUE * CIRCLE + RED * SQUARE&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="o">~</span><span class="n">query</span> <span class="o">&gt;&gt;</span> <span class="n">result</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Action-selection">
<h3>Action selection<a class="headerlink" href="#Action-selection" title="Permalink to this headline">¶</a></h3>
<p>Often it is necessary to choose one action out of a number of potential actions. This can be done with the <code class="docutils literal notranslate"><span class="pre">ActionSelection</span></code> object. It is used as a context manager und within its context <code class="docutils literal notranslate"><span class="pre">ifmax</span></code> function calls define the potential actions. You can pass an optional name as first argument to <code class="docutils literal notranslate"><span class="pre">ifmax</span></code>, but you don’t have to. The next argument is an expression that determines the utility value for the action being defined. The remaining arguments define where things should be routed, if the
action’s utility value is the highest of all the actions defined in the <code class="docutils literal notranslate"><span class="pre">ActionSelection</span></code> context.</p>
<p>In this example, we use this to cycle through a sequence of Semantic Pointers. Initially, we feed <code class="docutils literal notranslate"><span class="pre">A</span></code> into <code class="docutils literal notranslate"><span class="pre">state</span></code> to start things off and then we compute the dot product of the Semantic Pointer in <code class="docutils literal notranslate"><span class="pre">state</span></code> with the candidates and feed the next Semantic Pointer in the sequence to <code class="docutils literal notranslate"><span class="pre">state</span></code> accordingly.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;A&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;0&#39;</span>


<span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">spa_input</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Transcode</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">output_vocab</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>

    <span class="n">spa_input</span> <span class="o">&gt;&gt;</span> <span class="n">state</span>
    <span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">ActionSelection</span><span class="p">():</span>
        <span class="n">spa</span><span class="o">.</span><span class="n">ifmax</span><span class="p">(</span><span class="n">spa</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">A</span><span class="p">),</span>
                  <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">B</span> <span class="o">&gt;&gt;</span> <span class="n">state</span><span class="p">)</span>
        <span class="n">spa</span><span class="o">.</span><span class="n">ifmax</span><span class="p">(</span><span class="n">spa</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">B</span><span class="p">),</span>
                  <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">C</span> <span class="o">&gt;&gt;</span> <span class="n">state</span><span class="p">)</span>
        <span class="n">spa</span><span class="o">.</span><span class="n">ifmax</span><span class="p">(</span><span class="n">spa</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">C</span><span class="p">),</span>
                  <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">D</span> <span class="o">&gt;&gt;</span> <span class="n">state</span><span class="p">)</span>
        <span class="n">spa</span><span class="o">.</span><span class="n">ifmax</span><span class="p">(</span><span class="n">spa</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">D</span><span class="p">),</span>
                  <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">E</span> <span class="o">&gt;&gt;</span> <span class="n">state</span><span class="p">)</span>
        <span class="n">spa</span><span class="o">.</span><span class="n">ifmax</span><span class="p">(</span><span class="n">spa</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">E</span><span class="p">),</span>
                  <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">A</span> <span class="o">&gt;&gt;</span> <span class="n">state</span><span class="p">)</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">spa</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p</span><span class="p">],</span> <span class="n">state</span><span class="o">.</span><span class="n">vocab</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Similarity&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_intro_27_0.png" src="../_images/examples_intro_27_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Using-Transcode-for-computation">
<h2>Using Transcode for computation<a class="headerlink" href="#Using-Transcode-for-computation" title="Permalink to this headline">¶</a></h2>
<p>As mentioned before, the <code class="docutils literal notranslate"><span class="pre">Transcode</span></code> object is the analog to the Nengo <code class="docutils literal notranslate"><span class="pre">Node</span></code>. That means you can also use it for computation implemented in Python code. Let us take one of the previous examples, but implement the approximate inverse of the circular convolution in Python code. Note that <code class="docutils literal notranslate"><span class="pre">scene</span></code> and <code class="docutils literal notranslate"><span class="pre">x</span></code> are both SPA symbols, so the operations <code class="docutils literal notranslate"><span class="pre">*</span></code> and <code class="docutils literal notranslate"><span class="pre">~</span></code> still apply as defined in the SPA syntax.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">scene</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">BLUE</span> <span class="o">*</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">CIRCLE</span> <span class="o">+</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">RED</span> <span class="o">*</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">SQUARE</span>
    <span class="n">unbind</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Transcode</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">scene</span> <span class="o">*</span> <span class="o">~</span><span class="n">x</span><span class="p">,</span> <span class="n">input_vocab</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">output_vocab</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Transcode</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="s1">&#39;CIRCLE&#39;</span> <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">0.25</span> <span class="k">else</span> <span class="s1">&#39;SQUARE&#39;</span><span class="p">,</span> <span class="n">output_vocab</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>

    <span class="n">query</span> <span class="o">&gt;&gt;</span> <span class="n">unbind</span>
    <span class="n">unbind</span> <span class="o">&gt;&gt;</span> <span class="n">result</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">spa</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p</span><span class="p">],</span> <span class="n">result</span><span class="o">.</span><span class="n">vocab</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Similarity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_intro_31_0.png" src="../_images/examples_intro_31_0.png" />
</div>
</div>
</div>
<div class="section" id="Using-the-config-system-with-Nengo-SPA">
<h2>Using the config system with Nengo SPA<a class="headerlink" href="#Using-the-config-system-with-Nengo-SPA" title="Permalink to this headline">¶</a></h2>
<p>When building networks with Nengo SPA there is a number of parameters that will be set to predetermined values. Sometimes you might want to change these values. That can be done with the Nengo config system. In this example, we change the number of neurons implementing a <code class="docutils literal notranslate"><span class="pre">State</span></code>. Because we reduce the number of neurons by a lot, the start of the result will look much noisier.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">]</span><span class="o">.</span><span class="n">neurons_per_dimension</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="n">state</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">A</span> <span class="o">&gt;&gt;</span> <span class="n">state</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">spa</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p</span><span class="p">],</span> <span class="n">state</span><span class="o">.</span><span class="n">vocab</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Similarity&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Similarity&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_intro_35_1.png" src="../_images/examples_intro_35_1.png" />
</div>
</div>
</div>
<div class="section" id="Vocabularies">
<h2>Vocabularies<a class="headerlink" href="#Vocabularies" title="Permalink to this headline">¶</a></h2>
<p>Sometimes you will have sets of unrelated Semantic Pointers. It can be useful to keep them in distinct groups called <em>vocabularies</em>. You can create a vocabulary by instantiating a <code class="docutils literal notranslate"><span class="pre">spa.Vocabulary</span></code> object with the desired dimensionality. To fill it with Semantic Pointers, you can use the <code class="docutils literal notranslate"><span class="pre">populate</span></code> method which takes a string of Semantic Pointer names separated with semicolons. The vocabulary object will try to keep the maximum similarity between all pointers below a certain threshold (0.1 by
default).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">vocab</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Vocabulary</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">pointer_gen</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="n">vocab</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="s1">&#39;BLUE; RED; CIRCLE; SQUARE&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>If you happen to have a Python list of names, that can also be passed easily to <code class="docutils literal notranslate"><span class="pre">populate</span></code> with a little trick:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">list_of_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GREEN&#39;</span><span class="p">,</span> <span class="s1">&#39;YELLOW&#39;</span><span class="p">]</span>
<span class="n">vocab</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">list_of_names</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>You can also construct Semantic Pointers out of others.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">vocab</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    PURPLE = BLUE + RED;</span>
<span class="s1">    COLOR_MIX_1 = 0.8 * GREEN + 0.5 * YELLOW;</span>
<span class="s1">    SQUARING_THE_CIRCLE = CIRCLE * SQUARE&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Note that these Semantic Pointers will not be normalized to unit length. If you desire so, call <code class="docutils literal notranslate"><span class="pre">normalized()</span></code> on the constructed pointer. You can also use <code class="docutils literal notranslate"><span class="pre">unitary()</span></code> to get unitary Semantic Pointers.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">vocab</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    NORM_PURPLE = (BLUE + RED).normalized();</span>
<span class="s1">    UNITARY1.unitary();</span>
<span class="s1">    UNITARY2 = (SQUARE * CIRCLE).unitary()&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Sometimes you might already have a vector that you want to use as a Semantic Pointer instead of a randomly constructed one. These can be added to a vocabulary with the <code class="docutils literal notranslate"><span class="pre">add</span></code> method. Note, that this will not ensure the maximum similarity constraint.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="n">vocab</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;NULL&#39;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Vocabularies work like dictionaries. That means you can retrieve all contained Semantic Pointers with <code class="docutils literal notranslate"><span class="pre">keys()</span></code> and use indexing with Semantic Pointer names to retrieve specific pointers as <code class="docutils literal notranslate"><span class="pre">SemanticPointer</span></code> objects. Those specific pointers support the associated arithmetic operations (e.g., <code class="docutils literal notranslate"><span class="pre">+</span></code> for superposition, <code class="docutils literal notranslate"><span class="pre">*</span></code> for circular convolution). They can also be used in the SPA syntax, for example to provide them as input to modules. To access the actual vector use the <code class="docutils literal notranslate"><span class="pre">v</span></code> attribute.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;BLUE&#39;, &#39;RED&#39;, &#39;CIRCLE&#39;, &#39;SQUARE&#39;, &#39;GREEN&#39;, &#39;YELLOW&#39;, &#39;PURPLE&#39;, &#39;COLOR_MIX_1&#39;, &#39;SQUARING_THE_CIRCLE&#39;, &#39;NORM_PURPLE&#39;, &#39;UNITARY1&#39;, &#39;UNITARY2&#39;, &#39;NULL&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">blue</span> <span class="o">=</span> <span class="n">vocab</span><span class="p">[</span><span class="s1">&#39;BLUE&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">blue</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>
<span class="nb">print</span><span class="p">((</span><span class="n">blue</span> <span class="o">*</span> <span class="n">vocab</span><span class="p">[</span><span class="s1">&#39;RED&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ 0.29037237 -0.10935923 -0.09441741 -0.19180677  0.15470261 -0.41142928
  0.31190727 -0.1360754   0.05703229 -0.04457812  0.26137037 -0.36827633
 -0.05763617 -0.0686546   0.20267569 -0.19661954 -0.03082373 -0.15692835
  0.00754624  0.10418562 -0.19674966  0.20463391  0.1611708   0.08982725
  0.16103945 -0.12222504 -0.02196819 -0.16728068 -0.0478884   0.09480778
 -0.12364315 -0.07092473]
[-2.33592906e-01  1.20230697e-01 -1.81461860e-01  1.51189322e-01
 -3.02394960e-02  1.80646918e-01  2.04080856e-02  2.67529926e-01
 -1.71525203e-01 -1.49076698e-01 -3.89136163e-01  7.70771473e-02
  1.03376788e-02 -1.84943800e-02 -2.78839585e-02  3.48011970e-01
  4.95260398e-02  2.66837761e-02 -1.65875900e-01  5.28879043e-02
 -1.97860208e-01  3.28975664e-01 -3.15501481e-01 -1.57759818e-01
  6.05768126e-03  2.02859688e-01 -3.12011730e-01  7.45078372e-02
 -1.87441936e-01  2.31766730e-01 -5.49585899e-02  2.16370278e-04]
</pre></div></div>
</div>
<p>A vocabulary can also parse more complex expressions and return the resulting Semantic Pointer.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;BLUE * RED&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[-2.33592906e-01  1.20230697e-01 -1.81461860e-01  1.51189322e-01
 -3.02394960e-02  1.80646918e-01  2.04080856e-02  2.67529926e-01
 -1.71525203e-01 -1.49076698e-01 -3.89136163e-01  7.70771473e-02
  1.03376788e-02 -1.84943800e-02 -2.78839585e-02  3.48011970e-01
  4.95260398e-02  2.66837761e-02 -1.65875900e-01  5.28879043e-02
 -1.97860208e-01  3.28975664e-01 -3.15501481e-01 -1.57759818e-01
  6.05768126e-03  2.02859688e-01 -3.12011730e-01  7.45078372e-02
 -1.87441936e-01  2.31766730e-01 -5.49585899e-02  2.16370278e-04]
</pre></div></div>
</div>
<div class="section" id="Creating-subsets-of-vocabularies">
<h3>Creating subsets of vocabularies<a class="headerlink" href="#Creating-subsets-of-vocabularies" title="Permalink to this headline">¶</a></h3>
<p>In some cases it is useful to create a smaller subset from an existing vocabulary. This subset will use exactly the same vectors as in the original vocabulary.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">just_colors</span> <span class="o">=</span> <span class="n">vocab</span><span class="o">.</span><span class="n">create_subset</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;BLUE&#39;</span><span class="p">,</span> <span class="s1">&#39;RED&#39;</span><span class="p">,</span> <span class="s1">&#39;GREEN&#39;</span><span class="p">,</span> <span class="s1">&#39;YELLOW&#39;</span><span class="p">,</span> <span class="s1">&#39;PURPLE&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">just_colors</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;BLUE&#39;, &#39;RED&#39;, &#39;GREEN&#39;, &#39;YELLOW&#39;, &#39;PURPLE&#39;]
</pre></div></div>
</div>
</div>
<div class="section" id="Using-vocabularies">
<h3>Using vocabularies<a class="headerlink" href="#Using-vocabularies" title="Permalink to this headline">¶</a></h3>
<p>To use a manually created vocabulary in a model, pass it instead of the dimensionality to the module.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Strict-mode">
<h3>Strict mode<a class="headerlink" href="#Strict-mode" title="Permalink to this headline">¶</a></h3>
<p>Vocabularies that are manually instantiated will be in strict mode per default. That means trying to access a Semantic Pointer that does not exist in the vocabulary gives an exception. That can sometimes catch spelling mistakes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">vocab</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;UNKNOWN&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">spa</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">SpaParseError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Error parsing expression &#39;UNKNOWN&#39; with 32-dimensional vocab at 0x7f79e192bbe0: name &#39;UNKNOWN&#39; is not defined
</pre></div></div>
</div>
<p>In some cases, however, it is more useful to have unknown Semantic Pointers added to the vocabulary automatically. This happens when a vocabulary is created in non-strict mode.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">non_strict_vocab</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Vocabulary</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">non_strict_vocab</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;UNKNOWN&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SemanticPointer(array([ 0.02940641, -0.05648315, -0.23672575, -0.25770974, -0.27761793,
       -0.15991383,  0.11616912,  0.06037101,  0.10953893, -0.03544428,
        0.0353875 ,  0.30799318,  0.1824032 , -0.06663236, -0.01662437,
       -0.24375158,  0.30816035,  0.35235349,  0.18102452, -0.1439253 ,
        0.04082289,  0.12547309,  0.02590806, -0.22625801,  0.200073  ,
       -0.06122898,  0.27575057,  0.06446014, -0.11819663,  0.07710057,
        0.03062948, -0.24543724]), vocab=&lt;nengo_spa.vocabulary.Vocabulary object at 0x7f79e18bc2b0&gt;, algebra=&lt;nengo_spa.algebras.hrr_algebra.HrrAlgebra object at 0x7f79ed9313c8&gt;, name=&#39;UNKNOWN&#39;
</pre></div></div>
</div>
<p>The default vocabularies in Nengo SPA that are being used whenever you just specify the dimensionality for a module will be in non-strict mode.</p>
</div>
<div class="section" id="Converting-between-vocabularies">
<h3>Converting between vocabularies<a class="headerlink" href="#Converting-between-vocabularies" title="Permalink to this headline">¶</a></h3>
<p>When you want to combine Semantic Pointers from different vocabularies in any way, you will need to convert the Semantic Pointers from one vocabulary to the other vocabulary. There are different methods to do so.</p>
<p>First, you can use <code class="docutils literal notranslate"><span class="pre">reinterpret</span></code> to indicate that Semantic Pointers from one vocabulary should be interpreted in the context of another vocabulary without any change the actual represented vector. That requires both vocabularies to have the same dimensionality.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">just_colors</span><span class="p">)</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
    <span class="n">spa</span><span class="o">.</span><span class="n">reinterpret</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">vocab</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">state</span>
</pre></div>
</div>
</div>
<p>Second, you can use ‘translate’ to find a linear transform that tries to project the Semantic Pointers from one vocabulary to Semantic Pointers in the other vocabulary based on the names. This can be useful to use different dimensionalities for the same Semantic Pointers in different parts of your model.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pointers</span> <span class="o">=</span> <span class="s1">&#39;ONE; TWO; THREE&#39;</span>

<span class="n">low_d</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Vocabulary</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="n">low_d</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="n">pointers</span><span class="p">)</span>

<span class="n">high_d</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Vocabulary</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
<span class="n">high_d</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="n">pointers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">low_d_state</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">low_d</span><span class="p">)</span>
    <span class="n">high_d_state</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">high_d</span><span class="p">)</span>
    <span class="n">spa</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">low_d_state</span><span class="p">,</span> <span class="n">high_d</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">high_d_state</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Clean-up-memories">
<h2>Clean up memories<a class="headerlink" href="#Clean-up-memories" title="Permalink to this headline">¶</a></h2>
<p>The unbinding of a vector is only an approximate inverse. That means the result will contain some noise that in some cases needs to be removed. This can be done with clean-up or associative memories (a clean-up memory is basically an auto-associative memory). Nengo SPA provides a number of different variants of such associative memories. Here we demonstrate the clean-up with a <code class="docutils literal notranslate"><span class="pre">ThresholdingAssocMem</span></code>. It simply removes all vector components below a certain threshold (here <code class="docutils literal notranslate"><span class="pre">0.2</span></code>).</p>
<p>An associative memory needs to be provided with a vocabulary and all potential Semantic Pointers that it could clean up to with the <code class="docutils literal notranslate"><span class="pre">mapping</span></code> parameter. The <code class="docutils literal notranslate"><span class="pre">mapping</span></code> parameters allows to specify hetero-associative mappings, but here we just provide a sequence of keys which will create an auto-associative mapping.</p>
<p>Note that this subset is considered to be a different vocabulary than the default vocabulary itself. That means a simple <code class="docutils literal notranslate"><span class="pre">result</span> <span class="pre">&gt;&gt;</span> <span class="pre">am</span></code> will not work. But we know that both vocabularies use exactly the same vectors (because we created one as subset from the other) and thus can reinterpret the Semantic Pointer from <code class="docutils literal notranslate"><span class="pre">result</span></code> in the subset vocabulary. This is done with <code class="docutils literal notranslate"><span class="pre">spa.reinterpret(result)</span> <span class="pre">&gt;&gt;</span> <span class="pre">am</span></code>. In this case we do not need to provide the vocabulary as argument to <code class="docutils literal notranslate"><span class="pre">spa.reinterpret</span></code>
because it can be determined from the context. Keep in mind that this might not work in all cases and give an exception. Then you have to explicitly add the vocabulary as argument to <code class="docutils literal notranslate"><span class="pre">spa.reinterpret</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">scene</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Transcode</span><span class="p">(</span><span class="s1">&#39;BLUE * CIRCLE + RED * SQUARE&#39;</span><span class="p">,</span> <span class="n">output_vocab</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Transcode</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="s1">&#39;CIRCLE&#39;</span> <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">0.25</span> <span class="k">else</span> <span class="s1">&#39;SQUARE&#39;</span><span class="p">,</span> <span class="n">output_vocab</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">am</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">ThresholdingAssocMem</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">input_vocab</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;BLUE&#39;</span><span class="p">,</span> <span class="s1">&#39;RED&#39;</span><span class="p">])</span>

    <span class="n">scene</span> <span class="o">*</span> <span class="o">~</span><span class="n">query</span> <span class="o">&gt;&gt;</span> <span class="n">result</span>
    <span class="n">spa</span><span class="o">.</span><span class="n">reinterpret</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">am</span>

    <span class="n">p_result</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="n">p_am</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">am</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">spa</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_result</span><span class="p">],</span> <span class="n">model</span><span class="o">.</span><span class="n">vocabs</span><span class="p">[</span><span class="n">d</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Before clean-up&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Similarity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">vocabs</span><span class="p">[</span><span class="n">d</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">);</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">spa</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_am</span><span class="p">],</span> <span class="n">model</span><span class="o">.</span><span class="n">vocabs</span><span class="p">[</span><span class="n">d</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;After clean-up&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Times [s]&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_intro_68_0.png" src="../_images/examples_intro_68_0.png" />
</div>
</div>
</div>
<div class="section" id="What-is-next?">
<h2>What is next?<a class="headerlink" href="#What-is-next?" title="Permalink to this headline">¶</a></h2>
<p>This introduction gave a short overview of the core Nengo SPA features. But there is a lot more to most of them. Thus, you might want to delve deeper into certain parts of the documentation that are relevant to you or look at specific examples.</p>
</div>
</div>


            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div><footer class="text-light footer-main gradient-bottom">
  <p class="small text-center mb-0">
    <a class="no-hover-line" href="https://appliedbrainresearch.com">
      <img
        src="https://appliedbrainresearch.com/img/logo-blue-notext.svg"
        height="48"
      />
    </a>
    <a href="https://www.nengo.ai/">What is Nengo?</a>
    <a href="https://www.nengo.ai/examples/">Examples</a>
    <a href="https://www.nengo.ai/documentation/">Documentation</a>
    <a href="https://www.nengo.ai/getting-started/">Getting started</a>
    <a href="https://www.nengo.ai/privacy/">Privacy</a>
  </p>
  <p class="small text-center mb-0">&copy; Applied Brain Research</p>
</footer>
<script>
  function switchVersion(select) {
    var option = select.selectedOptions[0];
    if (option.hasAttribute("value")) {
      window.location = option.value;
    }
  }
</script>

<script>
  var elements = document.querySelectorAll('.sidenav');
  Stickyfill.add(elements);
</script>
<script>
  ScrollReveal().reveal(".fade-in", {
      scale: 0.85,
      duration: 1000,
      delay: 250,
      interval: 50
  });
</script>
<script>
  $('a.toggle-sidenav').on('click', function(e) {
    e.preventDefault();
    if ( $(this).hasClass('active') ) {
      $(this).removeClass('active');
      $('.sidenav').removeClass('open');
    } else {
      $(this).addClass('active');
      $('.sidenav').addClass('open');
    }
  });
</script>
<script>
  var lists = document.querySelectorAll('.toctree ul');
  lists.forEach((ul) => {
      ul.classList.add("nav");
  });
  var links = document.querySelectorAll('.toctree a');
  links.forEach((link) => {
      link.classList.add("nav-link");
  });
  $("body").scrollspy({target: ".sidenav"});
</script>
  </body>
</html>