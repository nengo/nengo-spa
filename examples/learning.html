
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Learning &#8212; NengoSPA 2.0.1.dev0 docs</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400;1,500;1,700&family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
<link rel="stylesheet" href="https://www.nengo.ai/css/bootstrap.css" type="text/css">
<style>
 body .title-bar,
 body .documentation-source h1:after {
   background-color: #d40000;
 }
</style>
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://unpkg.com/scrollreveal"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stickyfill/2.1.0/stickyfill.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
<!-- From basic/layout.html -->
<script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>


<script src="../_static/underscore.js"></script>


<script src="../_static/doctools.js"></script>


<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>


<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>


<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-GT8XEDLTMJ"></script>
        <script>
         window.dataLayer = window.dataLayer || [];
         function gtag(){dataLayer.push(arguments);}
         gtag('js', new Date());
         gtag('config', 'G-GT8XEDLTMJ');
        </script>
        <!-- End Google tag (gtag.js) -->
        <!-- Matomo -->
        <script>
         var _paq = window._paq = window._paq || [];
         _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
         _paq.push(["setCookieDomain", "*.appliedbrainresearch.com"]);
         _paq.push(["setDomains", ["*.appliedbrainresearch.com","*.edge.nengo.ai","*.forum.nengo.ai","*.nengo.ai"]]);
         _paq.push(["enableCrossDomainLinking"]);
         _paq.push(["setDoNotTrack", true]);
         _paq.push(['trackPageView']);
         _paq.push(['enableLinkTracking']);
         (function() {
           var u="https://appliedbrainresearch.matomo.cloud/";
           _paq.push(['setTrackerUrl', u+'matomo.php']);
           _paq.push(['setSiteId', '3']);
           var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
           g.async=true; g.src='//cdn.matomo.cloud/appliedbrainresearch.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
         })();
        </script>
        <!-- End Matomo Code -->
    
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Simple question answering" href="question.html" />
    <link rel="prev" title="Associative Memory" href="associative-memory.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  </head><body class="bg-dark"><!-- prettier-ignore -->


<header class="fixed-top header-top shadow-sm">
  <nav class="navbar navbar-expand-md navbar-light bg-white">
    <a class="navbar-brand" href="https://www.nengo.ai/">
      <img src="https://www.nengo.ai/design/_images/general-full-light.svg" alt="Nengo" class="logo" />
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapse"
      aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar-collapse">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="https://www.nengo.ai/">What is Nengo?</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://www.nengo.ai/examples/">Examples</a>
        </li>
        <li class="nav-item dropdown active">
          <a class="nav-link dropdown-toggle text-nowrap" id="navbar-dropdown-docs" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false" href="#">Documentation</a>
          <div class="dropdown-menu shadow-lg border-0" aria-labelledby="navbar-dropdown-docs">
            
            <a class="dropdown-item" href="https://www.nengo.ai/nengo/">Nengo core</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-gui/">NengoGUI</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-dl/">NengoDL</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-spa/">NengoSPA</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-extras/">NengoExtras</a>
            <a class="dropdown-item" href="https://arvoelke.github.io/nengolib-docs/">Nengolib</a>
            <a class="dropdown-item" href="https://www.nengo.ai/keras-spiking">KerasSpiking</a>
            <a class="dropdown-item" href="https://www.nengo.ai/pytorch-spiking">PyTorchSpiking</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-fpga/">NengoFPGA</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-loihi/">NengoLoihi</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-ocl/">NengoOCL</a>
            <a class="dropdown-item" href="https://github.com/project-rig/nengo_spinnaker">NengoSpiNNaker</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-mpi">NengoMPI</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/documentation/">All documentation</a>
          </div>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle text-nowrap" id="navbar-dropdown-community" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false" href="#">Community</a>
          <div class="dropdown-menu shadow-lg border-0" aria-labelledby="navbar-dropdown-community">
            <a class="dropdown-item" href="https://forum.nengo.ai">Forum</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/people/">People</a>
            <a class="dropdown-item" href="https://www.nengo.ai/summer-school/">Summer school</a>
            <a class="dropdown-item" href="https://www.nengo.ai/contributing/">Contributing</a>
            <a class="dropdown-item" href="https://www.nengo.ai/publications/">Publications</a>
            <a class="dropdown-item" href="https://www.nengo.ai/videos/">Videos</a>
            <a class="dropdown-item" href="https://www.nengo.ai/conduct/">Code of conduct</a>
            <a class="dropdown-item" href="https://www.nengo.ai/caa/">CAA</a>
          </div>
        </li>
      </ul>
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link btn btn-success btn-sm text-white" href="https://www.nengo.ai/getting-started/">Getting
            started</a>
        </li>
      </ul>
    </div>
  </nav>
</header>
<div class="main-content gradient-top">
  <div class="container-fluid">
    <div class="row"><a class="toggle-sidenav d-block d-md-none" href="#"
  ><i class="icon-close fa fa-fw fa-arrow-left"></i
  ><i class="icon-open fa fa-fw fa-arrow-right"></i
></a>
<div role="complementary" class="sidenav col-4 col-xl-3 p-0 border-right">
  <h3 class="pt-5 px-5">
    <a href="../index.html">
      <img
        class="img-fluid documentation-image"
        src="https://www.nengo.ai/design/_images/nengo-spa-full-light.svg"
        alt="NengoSPA"
      />
    </a>
  </h3>
<form class="px-5 py-3 my-0 border-bottom" action="../search.html" method="get">
  <div class="form-group form-group-single">
    <input type="text" name="q" class="form-control" placeholder="Search" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <button type="submit" class="btn btn-link">
      <img src="https://www.nengo.ai/img/icon-search.svg" alt="Go" />
    </button>
  </div>
</form><div class="p-5 toctree">
  
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-guide.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="convolution.html">Convolution network</a></li>
<li class="toctree-l2"><a class="reference internal" href="associative-memory.html">Associative Memory</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Learning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Method-1:-Represent-the-Semantic-Pointers-in-single,-large-ensembles">Method 1: Represent the Semantic Pointers in single, large ensembles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Method-2:-Create-multiple,-pairwise-connections-between-the-state-ensembles">Method 2: Create multiple, pairwise connections between the state ensembles</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="question.html">Simple question answering</a></li>
<li class="toctree-l2"><a class="reference internal" href="question-control.html">Controlled question answering</a></li>
<li class="toctree-l2"><a class="reference internal" href="question-memory.html">Simple question answering with memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="spa-sequence.html">Routing through a sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="spa-sequence-routed.html">Routed sequencing</a></li>
<li class="toctree-l2"><a class="reference internal" href="spa-parser.html">Parsing simple commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="vocabulary-casting.html">Vocabulary casting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developer Guide</a></li>
</ul>

  
  </div>
  
  <form class="p-5 my-0 border-top">
    <div class="form-group">
      <label class="text-gray">Version:</label>
      <select class="custom-select" onchange="switchVersion(this);">
        
        
        <option selected>latest</option>
        
        
          
        <option value="../v1.3.0/examples/learning.html">
          v1.3.0
        </option>
          
        
          
        <option value="../v1.2.0/examples/learning.html">
          v1.2.0
        </option>
          
        
          
        <option value="../v1.1.1/examples/learning.html">
          v1.1.1
        </option>
          
        
          
        <option value="../v1.1.0/examples/learning.html">
          v1.1.0
        </option>
          
        
      </select>
    </div>
  </form>
  
</div>
      

      <div class="col-12 col-md-8 col-xl-9">
        <div class="container">
          <div class="row">
            <div class="col-10 offset-1 pb-5 documentation-source" role="main">
              
              
              <div class="admonition note">
                  <p class="admonition-title">Note</p>
                  <p>
                  This documentation is for a development version.
                  <a href="../v1.3.0/examples/learning.html">
                  Click here for the latest stable release (v1.3.0).
                  </a>
                  </p>
              </div>
              
              
  <div class="section" id="Learning">
<h1>Learning<a class="headerlink" href="#Learning" title="Permalink to this headline">¶</a></h1>
<p>This example shows two ways of implementing learning in the context of NengoSPA. It assumes some basic knowledge of learning in Nengo core, so you might want to check out <a class="reference external" href="https://www.nengo.ai/nengo/examples.html#learning">those examples</a> first.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">nengo</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">cycler</span> <span class="kn">import</span> <span class="n">cycler</span>

<span class="kn">import</span> <span class="nn">nengo_spa</span> <span class="k">as</span> <span class="nn">spa</span>

<span class="n">seed</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>In this example, we will be learning simple associations from fruits (orange, apricot, cherry, apple) to their colors (orange, yellow, red, green). Thus, we will set up vocabularies accordingly and define the desired target associations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dim</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">vocab_fruits</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Vocabulary</span><span class="p">(</span><span class="n">dimensions</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span> <span class="n">pointer_gen</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="n">vocab_colors</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Vocabulary</span><span class="p">(</span><span class="n">dimensions</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span> <span class="n">pointer_gen</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>

<span class="n">fruits</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ORANGE&quot;</span><span class="p">,</span> <span class="s2">&quot;APRICOT&quot;</span><span class="p">,</span> <span class="s2">&quot;CHERRY&quot;</span><span class="p">,</span> <span class="s2">&quot;APPLE&quot;</span><span class="p">]</span>
<span class="n">vocab_fruits</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fruits</span><span class="p">))</span>

<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ORANGE&quot;</span><span class="p">,</span> <span class="s2">&quot;YELLOW&quot;</span><span class="p">,</span> <span class="s2">&quot;RED&quot;</span><span class="p">,</span> <span class="s2">&quot;GREEN&quot;</span><span class="p">]</span>
<span class="n">vocab_colors</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">colors</span><span class="p">))</span>

<span class="n">targets</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;ORANGE&quot;</span><span class="p">:</span> <span class="s2">&quot;ORANGE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;APRICOT&quot;</span><span class="p">:</span> <span class="s2">&quot;YELLOW&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CHERRY&quot;</span><span class="p">:</span> <span class="s2">&quot;RED&quot;</span><span class="p">,</span>
    <span class="s2">&quot;APPLE&quot;</span><span class="p">:</span> <span class="s2">&quot;GREEN&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">matplotlib_colors</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;ORANGE&quot;</span><span class="p">:</span> <span class="s2">&quot;tab:orange&quot;</span><span class="p">,</span>
    <span class="s2">&quot;YELLOW&quot;</span><span class="p">:</span> <span class="s2">&quot;yellow&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RED&quot;</span><span class="p">:</span> <span class="s2">&quot;tab:red&quot;</span><span class="p">,</span>
    <span class="s2">&quot;GREEN&quot;</span><span class="p">:</span> <span class="s2">&quot;tab:green&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">matplotlib_color_cycle</span> <span class="o">=</span> <span class="n">cycler</span><span class="p">(</span>
    <span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">matplotlib_colors</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vocab_colors</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Furthermore, we define some variables:</p>
<ul class="simple">
<li><p>length of the learning period,</p></li>
<li><p>the duration each item will be shown before switching to the next one,</p></li>
<li><p>and the total simulation time.</p></li>
</ul>
<p>We also define some helper functions to provide the desired inputs to the model.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">item_seconds</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">learn_for_seconds</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">item_seconds</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">fruits</span><span class="p">)</span>

<span class="n">run_for_seconds</span> <span class="o">=</span> <span class="n">learn_for_seconds</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">fruits</span><span class="p">)</span> <span class="o">*</span> <span class="n">item_seconds</span>


<span class="k">def</span> <span class="nf">is_recall</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="n">learn_for_seconds</span>


<span class="k">def</span> <span class="nf">current_item</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">fruits</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span> <span class="o">//</span> <span class="n">item_seconds</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">fruits</span><span class="p">)]</span>


<span class="k">def</span> <span class="nf">current_target</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">targets</span><span class="p">[</span><span class="n">current_item</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="section" id="Method-1:-Represent-the-Semantic-Pointers-in-single,-large-ensembles">
<h2>Method 1: Represent the Semantic Pointers in single, large ensembles<a class="headerlink" href="#Method-1:-Represent-the-Semantic-Pointers-in-single,-large-ensembles" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">State</span></code> module in NengoSPA isn’t a single ensemble, but a slightly more complex network to ensure an accurate representation of Semantic Pointers. However, learning connections work between individual ensembles and not whole networks. To implement learning between two SPA <code class="docutils literal notranslate"><span class="pre">State</span></code> modules, we can configure the modules to produce only single ensembles and connect those with a learning connection.</p>
<p>Two parameters are important for this:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">subdimensions</span></code> needs to be set to the total dimensionality of the <code class="docutils literal notranslate"><span class="pre">State</span></code>’s vocabulary,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">represent_cc_identity</span></code> must be set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">State</span></code> ensemble itself can then be accessed via the <code class="docutils literal notranslate"><span class="pre">all_ensembles</span></code> property, which will only have a single element in this case.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="c1"># Inputs to the model</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Transcode</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">vocab_fruits</span><span class="p">[</span><span class="n">current_item</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span> <span class="n">output_vocab</span><span class="o">=</span><span class="n">vocab_fruits</span>
    <span class="p">)</span>
    <span class="n">target</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Transcode</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">vocab_colors</span><span class="p">[</span><span class="n">current_target</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span> <span class="n">output_vocab</span><span class="o">=</span><span class="n">vocab_colors</span>
    <span class="p">)</span>

    <span class="c1"># States/ensembles for learning</span>
    <span class="c1"># Note that the `error` state may use multiple ensembles.</span>
    <span class="n">pre_state</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span>
        <span class="n">vocab_fruits</span><span class="p">,</span> <span class="n">subdimensions</span><span class="o">=</span><span class="n">vocab_fruits</span><span class="o">.</span><span class="n">dimensions</span><span class="p">,</span> <span class="n">represent_cc_identity</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">post_state</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span>
        <span class="n">vocab_colors</span><span class="p">,</span> <span class="n">subdimensions</span><span class="o">=</span><span class="n">vocab_colors</span><span class="o">.</span><span class="n">dimensions</span><span class="p">,</span> <span class="n">represent_cc_identity</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">vocab_colors</span><span class="p">)</span>

    <span class="c1"># Setup the item input and error signals</span>
    <span class="n">item</span> <span class="o">&gt;&gt;</span> <span class="n">pre_state</span>
    <span class="o">-</span><span class="n">post_state</span> <span class="o">&gt;&gt;</span> <span class="n">error</span>
    <span class="n">target</span> <span class="o">&gt;&gt;</span> <span class="n">error</span>

    <span class="c1"># Create the learning connection with some randomly initialized weights</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">pre_state</span><span class="o">.</span><span class="n">all_ensembles</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">post_state</span><span class="o">.</span><span class="n">all_ensembles</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="n">learning_connection</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span>
        <span class="n">pre_state</span><span class="o">.</span><span class="n">all_ensembles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">post_state</span><span class="o">.</span><span class="n">all_ensembles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">vocab_colors</span><span class="o">.</span><span class="n">dimensions</span><span class="p">),</span>
        <span class="n">learning_rule_type</span><span class="o">=</span><span class="n">nengo</span><span class="o">.</span><span class="n">PES</span><span class="p">(</span><span class="mf">0.00015</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">learning_connection</span><span class="o">.</span><span class="n">learning_rule</span><span class="p">,</span> <span class="n">transform</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Suppress learning in the final iteration to test recall</span>
    <span class="n">is_recall_node</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">is_recall</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ens</span> <span class="ow">in</span> <span class="n">error</span><span class="o">.</span><span class="n">all_ensembles</span><span class="p">:</span>
        <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span>
            <span class="n">is_recall_node</span><span class="p">,</span> <span class="n">ens</span><span class="o">.</span><span class="n">neurons</span><span class="p">,</span> <span class="n">transform</span><span class="o">=-</span><span class="mi">100</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">ens</span><span class="o">.</span><span class="n">n_neurons</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="p">)</span>

    <span class="c1"># Probes to record simulation data</span>
    <span class="n">p_target</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
    <span class="n">p_error</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="n">p_post_state</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">post_state</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">run_for_seconds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>As a sanity check we can look at the norm of the error and see it decrease.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_error</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">learn_for_seconds</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Error signal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Error norm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Error norm&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_learning_10_1.png" src="../_images/examples_learning_10_1.png" />
</div>
</div>
<p>And here is the recall of the learned associations compared to the target colors:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="n">matplotlib_color_cycle</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">spa</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_target</span><span class="p">],</span> <span class="n">vocab_colors</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Target colors&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Similarity&quot;</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="n">matplotlib_color_cycle</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">spa</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_post_state</span><span class="p">],</span> <span class="n">vocab_colors</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">learn_for_seconds</span><span class="p">,</span> <span class="n">run_for_seconds</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Recalled colors&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time [s]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Similarity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_learning_12_0.png" src="../_images/examples_learning_12_0.png" />
</div>
</div>
<div class="section" id="Considerations">
<h3>Considerations<a class="headerlink" href="#Considerations" title="Permalink to this headline">¶</a></h3>
<p>This approach allows for full connectivity between the two <code class="docutils literal notranslate"><span class="pre">State</span></code> modules. Thus, any linear transform could be learned in theory.</p>
<p>However, single ensembles representing large dimensionalities need much more neurons to achieve the same representational accuracy compared to multiple ensembles, where each only represents a subset of all dimensions. Additionally, the model build time and memory usage can be a problem with such large ensembles.</p>
</div>
</div>
<div class="section" id="Method-2:-Create-multiple,-pairwise-connections-between-the-state-ensembles">
<h2>Method 2: Create multiple, pairwise connections between the state ensembles<a class="headerlink" href="#Method-2:-Create-multiple,-pairwise-connections-between-the-state-ensembles" title="Permalink to this headline">¶</a></h2>
<p>Instead of configuring the <code class="docutils literal notranslate"><span class="pre">State</span></code> modules to use only a single ensemble, we can use the default configuration with multiple ensembles and create a separate connection between each pair of ensembles in the pre-synaptic and post-synaptic <code class="docutils literal notranslate"><span class="pre">State</span></code>. This can be done with a simple <code class="docutils literal notranslate"><span class="pre">for</span></code> loop and using <code class="docutils literal notranslate"><span class="pre">zip</span></code> to create the appropriate ensemble pairs. In addition, we need to connect the error signal analogously.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="c1"># Inputs to the model</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Transcode</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">vocab_fruits</span><span class="p">[</span><span class="n">current_item</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span> <span class="n">output_vocab</span><span class="o">=</span><span class="n">vocab_fruits</span>
    <span class="p">)</span>
    <span class="n">target</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Transcode</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">vocab_colors</span><span class="p">[</span><span class="n">current_target</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span> <span class="n">output_vocab</span><span class="o">=</span><span class="n">vocab_colors</span>
    <span class="p">)</span>

    <span class="c1"># States/ensembles for learning</span>
    <span class="n">pre_state</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">vocab_fruits</span><span class="p">)</span>
    <span class="n">post_state</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">vocab_colors</span><span class="p">)</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">vocab_colors</span><span class="p">)</span>

    <span class="c1"># Setup the item input and error signals</span>
    <span class="n">item</span> <span class="o">&gt;&gt;</span> <span class="n">pre_state</span>
    <span class="o">-</span><span class="n">post_state</span> <span class="o">&gt;&gt;</span> <span class="n">error</span>
    <span class="n">target</span> <span class="o">&gt;&gt;</span> <span class="n">error</span>

    <span class="c1"># Create pairwise learning connections with randomly initialized weights</span>
    <span class="k">for</span> <span class="n">pre_ensemble</span><span class="p">,</span> <span class="n">post_ensemble</span><span class="p">,</span> <span class="n">error_ensemble</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">pre_state</span><span class="o">.</span><span class="n">all_ensembles</span><span class="p">,</span> <span class="n">post_state</span><span class="o">.</span><span class="n">all_ensembles</span><span class="p">,</span> <span class="n">error</span><span class="o">.</span><span class="n">all_ensembles</span>
    <span class="p">):</span>
        <span class="n">learning_connection</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span>
            <span class="n">pre_ensemble</span><span class="p">,</span>
            <span class="n">post_ensemble</span><span class="p">,</span>
            <span class="n">function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">post_ensemble</span><span class="o">=</span><span class="n">post_ensemble</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span>
                <span class="n">post_ensemble</span><span class="o">.</span><span class="n">dimensions</span>
            <span class="p">),</span>
            <span class="n">learning_rule_type</span><span class="o">=</span><span class="n">nengo</span><span class="o">.</span><span class="n">PES</span><span class="p">(</span><span class="mf">0.00015</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span>
            <span class="n">error_ensemble</span><span class="p">,</span> <span class="n">learning_connection</span><span class="o">.</span><span class="n">learning_rule</span><span class="p">,</span> <span class="n">transform</span><span class="o">=-</span><span class="mi">1</span>
        <span class="p">)</span>

    <span class="c1"># Suppress learning in the final iteration to test recall</span>
    <span class="n">is_recall_node</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">is_recall</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ens</span> <span class="ow">in</span> <span class="n">error</span><span class="o">.</span><span class="n">all_ensembles</span><span class="p">:</span>
        <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span>
            <span class="n">is_recall_node</span><span class="p">,</span> <span class="n">ens</span><span class="o">.</span><span class="n">neurons</span><span class="p">,</span> <span class="n">transform</span><span class="o">=-</span><span class="mi">100</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">ens</span><span class="o">.</span><span class="n">n_neurons</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="p">)</span>

    <span class="c1"># Probes to record simulation data</span>
    <span class="n">p_target</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
    <span class="n">p_error</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="n">p_post_state</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">post_state</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">run_for_seconds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can look at the error signal again as a sanity check:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_error</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">learn_for_seconds</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Error signal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Error norm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Error norm&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_learning_18_1.png" src="../_images/examples_learning_18_1.png" />
</div>
</div>
<p>The recall of the learned associations:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="n">matplotlib_color_cycle</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">spa</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_target</span><span class="p">],</span> <span class="n">vocab_colors</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Target colors&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Similarity&quot;</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="n">matplotlib_color_cycle</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">spa</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_post_state</span><span class="p">],</span> <span class="n">vocab_colors</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">learn_for_seconds</span><span class="p">,</span> <span class="n">run_for_seconds</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Recalled colors&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time [s]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Similarity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_learning_20_0.png" src="../_images/examples_learning_20_0.png" />
</div>
</div>
<div class="section" id="id1">
<h3>Considerations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>By using the default ensemble configuration, this approach scales better with regards to build time and representational accuracy. However, the space of potentially learnable functions is limited. Only connectivity matrices with a block diagonal structure can be learned. It is not possible to learn a connection from the <span class="math notranslate nohighlight">\(n\)</span>-th pre-ensemble to the <span class="math notranslate nohighlight">\(m\)</span>-th post-ensemble for <span class="math notranslate nohighlight">\(n \neq m\)</span>. This can be fine for certain use cases, such as learning associations, but might not be fine for
other use cases. For example, learning the involution is probably not possible with this approach as it requires reversing most of the vector.</p>
</div>
</div>
</div>


            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div><footer class="text-light footer-main gradient-bottom-center">
  <p class="text-center">
    <a class="no-hover-line" href="https://appliedbrainresearch.com">
      <img class="abr-logo" src="https://www.nengo.ai/img/abr-logo.svg" height="32" />
    </a>
    <a href="https://www.nengo.ai/">What is Nengo?</a>
    <a href="https://www.nengo.ai/examples/">Examples</a>
    <a href="https://www.nengo.ai/documentation/">Documentation</a>
    <a href="https://www.nengo.ai/getting-started/">Getting started</a>
    <a href="https://www.nengo.ai/privacy/">Privacy</a>
  </p>
  <p class="small text-center pb-0 mb-0">&copy; Applied Brain Research</p>
</footer>
<script>
  function switchVersion(select) {
    var option = select.selectedOptions[0];
    if (option.hasAttribute("value")) {
      window.location = option.value;
    }
  }
</script>

<script>
  var elements = document.querySelectorAll('.sidenav');
  Stickyfill.add(elements);
</script>
<script>
  ScrollReveal().reveal(".fade-in", {
      scale: 0.85,
      duration: 1000,
      delay: 250,
      interval: 50
  });
</script>
<script>
  $('a.toggle-sidenav').on('click', function(e) {
    e.preventDefault();
    if ( $(this).hasClass('active') ) {
      $(this).removeClass('active');
      $('.sidenav').removeClass('open');
    } else {
      $(this).addClass('active');
      $('.sidenav').addClass('open');
    }
  });
</script>
<script>
  var lists = document.querySelectorAll('.toctree ul');
  lists.forEach((ul) => {
      ul.classList.add("nav");
  });
  var links = document.querySelectorAll('.toctree a');
  links.forEach((link) => {
      link.classList.add("nav-link");
  });
  $("body").scrollspy({target: ".sidenav"});
</script>
  </body>
</html>