
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Associative Memory &#8212; NengoSPA 2.0.0 docs</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400;1,500;1,700&family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
<link rel="stylesheet" href="https://www.nengo.ai/css/bootstrap.css" type="text/css">
<style>
 body .title-bar,
 body .documentation-source h1:after {
   background-color: #d40000;
 }
</style>
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://unpkg.com/scrollreveal"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stickyfill/2.1.0/stickyfill.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
<!-- From basic/layout.html -->
<script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>


<script src="../_static/underscore.js"></script>


<script src="../_static/doctools.js"></script>


<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>


<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>


<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-GT8XEDLTMJ"></script>
        <script>
         window.dataLayer = window.dataLayer || [];
         function gtag(){dataLayer.push(arguments);}
         gtag('js', new Date());
         gtag('config', 'G-GT8XEDLTMJ');
        </script>
        <!-- End Google tag (gtag.js) -->
        <!-- Matomo -->
        <script>
         var _paq = window._paq = window._paq || [];
         _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
         _paq.push(["setCookieDomain", "*.appliedbrainresearch.com"]);
         _paq.push(["setDomains", ["*.appliedbrainresearch.com","*.edge.nengo.ai","*.forum.nengo.ai","*.nengo.ai"]]);
         _paq.push(["enableCrossDomainLinking"]);
         _paq.push(["setDoNotTrack", true]);
         _paq.push(['trackPageView']);
         _paq.push(['enableLinkTracking']);
         (function() {
           var u="https://appliedbrainresearch.matomo.cloud/";
           _paq.push(['setTrackerUrl', u+'matomo.php']);
           _paq.push(['setSiteId', '3']);
           var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
           g.async=true; g.src='//cdn.matomo.cloud/appliedbrainresearch.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
         })();
        </script>
        <!-- End Matomo Code -->
    
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Learning" href="learning.html" />
    <link rel="prev" title="Convolution network" href="convolution.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  </head><body class="bg-dark"><!-- prettier-ignore -->


<header class="fixed-top header-top shadow-sm">
  <nav class="navbar navbar-expand-md navbar-light bg-white">
    <a class="navbar-brand" href="https://www.nengo.ai/">
      <img src="https://www.nengo.ai/design/_images/general-full-light.svg" alt="Nengo" class="logo" />
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapse"
      aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar-collapse">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="https://www.nengo.ai/">What is Nengo?</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://www.nengo.ai/examples/">Examples</a>
        </li>
        <li class="nav-item dropdown active">
          <a class="nav-link dropdown-toggle text-nowrap" id="navbar-dropdown-docs" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false" href="#">Documentation</a>
          <div class="dropdown-menu shadow-lg border-0" aria-labelledby="navbar-dropdown-docs">
            
            <a class="dropdown-item" href="https://www.nengo.ai/nengo/">Nengo core</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-gui/">NengoGUI</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-dl/">NengoDL</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-spa/">NengoSPA</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-extras/">NengoExtras</a>
            <a class="dropdown-item" href="https://arvoelke.github.io/nengolib-docs/">Nengolib</a>
            <a class="dropdown-item" href="https://www.nengo.ai/keras-spiking">KerasSpiking</a>
            <a class="dropdown-item" href="https://www.nengo.ai/pytorch-spiking">PyTorchSpiking</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-fpga/">NengoFPGA</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-loihi/">NengoLoihi</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-ocl/">NengoOCL</a>
            <a class="dropdown-item" href="https://github.com/project-rig/nengo_spinnaker">NengoSpiNNaker</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-mpi">NengoMPI</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/documentation/">All documentation</a>
          </div>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle text-nowrap" id="navbar-dropdown-community" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false" href="#">Community</a>
          <div class="dropdown-menu shadow-lg border-0" aria-labelledby="navbar-dropdown-community">
            <a class="dropdown-item" href="https://forum.nengo.ai">Forum</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/people/">People</a>
            <a class="dropdown-item" href="https://www.nengo.ai/summer-school/">Summer school</a>
            <a class="dropdown-item" href="https://www.nengo.ai/contributing/">Contributing</a>
            <a class="dropdown-item" href="https://www.nengo.ai/publications/">Publications</a>
            <a class="dropdown-item" href="https://www.nengo.ai/videos/">Videos</a>
            <a class="dropdown-item" href="https://www.nengo.ai/conduct/">Code of conduct</a>
            <a class="dropdown-item" href="https://www.nengo.ai/caa/">CAA</a>
          </div>
        </li>
      </ul>
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link btn btn-success btn-sm text-white" href="https://www.nengo.ai/getting-started/">Getting
            started</a>
        </li>
      </ul>
    </div>
  </nav>
</header>
<div class="main-content gradient-top">
  <div class="container-fluid">
    <div class="row"><a class="toggle-sidenav d-block d-md-none" href="#"
  ><i class="icon-close fa fa-fw fa-arrow-left"></i
  ><i class="icon-open fa fa-fw fa-arrow-right"></i
></a>
<div role="complementary" class="sidenav col-4 col-xl-3 p-0 border-right">
  <h3 class="pt-5 px-5">
    <a href="../index.html">
      <img
        class="img-fluid documentation-image"
        src="https://www.nengo.ai/design/_images/nengo-spa-full-light.svg"
        alt="NengoSPA"
      />
    </a>
  </h3>
<form class="px-5 py-3 my-0 border-bottom" action="../search.html" method="get">
  <div class="form-group form-group-single">
    <input type="text" name="q" class="form-control" placeholder="Search" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <button type="submit" class="btn btn-link">
      <img src="https://www.nengo.ai/img/icon-search.svg" alt="Go" />
    </button>
  </div>
</form><div class="p-5 toctree">
  
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-guide.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="convolution.html">Convolution network</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Associative Memory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Step-1:-Creating-an-Associative-Memory">Step 1: Creating an Associative Memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Step-2:-Clean-up-Memory">Step 2: Clean-up Memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#WTA-Memory">WTA Memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Step-3:-Heteroassociative-relationships">Step 3: Heteroassociative relationships</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="learning.html">Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="question.html">Simple question answering</a></li>
<li class="toctree-l2"><a class="reference internal" href="question-control.html">Controlled question answering</a></li>
<li class="toctree-l2"><a class="reference internal" href="question-memory.html">Simple question answering with memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="spa-sequence.html">Routing through a sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="spa-sequence-routed.html">Routed sequencing</a></li>
<li class="toctree-l2"><a class="reference internal" href="spa-parser.html">Parsing simple commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="vocabulary-casting.html">Vocabulary casting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developer Guide</a></li>
</ul>

  
  </div>
  
  <form class="p-5 my-0 border-top">
    <div class="form-group">
      <label class="text-gray">Version:</label>
      <select class="custom-select" onchange="switchVersion(this);">
        
        
        <option selected>latest</option>
        
        
          
        <option value="../v1.3.0/examples/associative-memory.html">
          v1.3.0
        </option>
          
        
          
        <option value="../v1.2.0/examples/associative-memory.html">
          v1.2.0
        </option>
          
        
          
        <option value="../v1.1.1/examples/associative-memory.html">
          v1.1.1
        </option>
          
        
          
        <option value="../v1.1.0/examples/associative-memory.html">
          v1.1.0
        </option>
          
        
      </select>
    </div>
  </form>
  
</div>
      

      <div class="col-12 col-md-8 col-xl-9">
        <div class="container">
          <div class="row">
            <div class="col-10 offset-1 pb-5 documentation-source" role="main">
              
              
              <div class="admonition note">
                  <p class="admonition-title">Note</p>
                  <p>
                  This documentation is for a development version.
                  <a href="../v1.3.0/examples/associative-memory.html">
                  Click here for the latest stable release (v1.3.0).
                  </a>
                  </p>
              </div>
              
              
  <div class="section" id="Associative-Memory">
<h1>Associative Memory<a class="headerlink" href="#Associative-Memory" title="Permalink to this headline">¶</a></h1>
<p>This tutorial introduces the Associative Memory (AM) module in the SPA.</p>
<p>An associative memory is a neural network used to store and recall patterns. When the network receives a partial or noisy pattern at the input, it can either recover the same pattern or recall another stored pattern. If the recovered pattern is the same as the input pattern, the memory is said to be autoassociative or a <em>clean-up</em> memory. Otherwise, if the recovered pattern is different from the presented one, the network is heteroassociative.</p>
<p>Patterns stored by the AM module in the SPA are semantic pointers organised in a SPA vocabulary. The examples in this tutorial demonstrate how to use the AM module to store and recall patterns. Advanced functionality of the module, such as the recall of multiple memories similar to the input, is also presented.</p>
<p>A theoretical explanation on how the associative memory is implemented in NEF is available in <a class="reference external" href="http://compneuro.uwaterloo.ca/publications/stewart2011.html">Stewart et al. 2011</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">nengo</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">nengo_spa</span> <span class="k">as</span> <span class="nn">spa</span>

<span class="n">seed</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Step-1:-Creating-an-Associative-Memory">
<h2>Step 1: Creating an Associative Memory<a class="headerlink" href="#Step-1:-Creating-an-Associative-Memory" title="Permalink to this headline">¶</a></h2>
<p>We start by creating a set of patterns the AM will store. The vocabulary in this example contains five words: <code class="docutils literal notranslate"><span class="pre">ORANGE,</span> <span class="pre">APRICOT,</span> <span class="pre">CHERRY,</span> <span class="pre">STRAWBERRY</span></code> and <code class="docutils literal notranslate"><span class="pre">APPLE</span></code>. Each word is represented as a semantic pointer, an <span class="math notranslate nohighlight">\(n\)</span>-dimensional vector. When creating a vocabulary, we specify the number of dimensions for all semantic pointers. Then, we add the words to the vocabulary with <code class="docutils literal notranslate"><span class="pre">populate</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dim</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">vocab</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Vocabulary</span><span class="p">(</span><span class="n">dimensions</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span> <span class="n">pointer_gen</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>

<span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ORANGE&quot;</span><span class="p">,</span> <span class="s2">&quot;APRICOT&quot;</span><span class="p">,</span> <span class="s2">&quot;CHERRY&quot;</span><span class="p">,</span> <span class="s2">&quot;STRAWBERRY&quot;</span><span class="p">,</span> <span class="s2">&quot;APPLE&quot;</span><span class="p">]</span>
<span class="n">vocab</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">words</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Next, we create an autoassociative memory with a corresponding set of stored patterns. To check the functionality of the memory module, we want to test whether the pattern at the input has been successfully retrieved at the output.</p>
<p>The memory is created within a <code class="docutils literal notranslate"><span class="pre">spa.Network</span></code> module. We set the Semantic Pointer <code class="docutils literal notranslate"><span class="pre">APPLE</span></code> as the input to the associative memory. <code class="docutils literal notranslate"><span class="pre">nengo.Probe</span></code>s have been added to record inputs and outputs of the module, which we plot for visual inspection. Finally, we run the simulation for the 0.2 seconds simulation time.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="s2">&quot;AssociativeMemory&quot;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="c1"># create the AM module</span>
    <span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">ThresholdingAssocMem</span><span class="p">(</span>
        <span class="n">threshold</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">input_vocab</span><span class="o">=</span><span class="n">vocab</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">vocab</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="c1"># present input to the AM</span>
    <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">APPLE</span> <span class="o">&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span>

    <span class="c1"># record the inputs and outputs during the simulation</span>
    <span class="n">input_probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
    <span class="n">output_probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>

<span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We gather the simulation data:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input dimensions: </span><span class="si">{</span><span class="nb">tuple</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">input_probe</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output dimensions: </span><span class="si">{</span><span class="nb">tuple</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">output_probe</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Input dimensions: (200, 64)
Output dimensions: (200, 64)
</pre></div></div>
</div>
<p>We use a dot product (implemented in <code class="docutils literal notranslate"><span class="pre">spa.similarity</span></code>) to compare the similarity of inputs and outputs to all patterns in the vocabulary at every time step. Recall that the first dimension corresponds to the number of time steps and the second dimension to the 32-dimensional pattern represented in the associative memory. If the similarity between the output vector and the input vector is close to one, we can say that the associative memory successfully retrieved the pattern (or cleaned up the
input).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_similarities</span><span class="p">(</span>
    <span class="n">t_range</span><span class="p">,</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">output_data</span><span class="p">,</span> <span class="n">vocab1</span><span class="p">,</span> <span class="n">vocab2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">autoscale</span><span class="o">=</span><span class="kc">False</span>
<span class="p">):</span>
    <span class="k">if</span> <span class="n">vocab2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vocab2</span> <span class="o">=</span> <span class="n">vocab1</span>

    <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">autoscale</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">autoscale</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">spa</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">vocab1</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Input similarity&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="n">t_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
        <span class="nb">list</span><span class="p">(</span><span class="n">vocab1</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.13</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">spa</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">output_data</span><span class="p">,</span> <span class="n">vocab2</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Output similarity&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="n">t_range</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">autoscale</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">autoscale</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
        <span class="nb">list</span><span class="p">(</span><span class="n">vocab2</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.13</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_similarities</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">input_probe</span><span class="p">],</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">output_probe</span><span class="p">],</span> <span class="n">vocab</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_associative-memory_10_0.png" src="../_images/examples_associative-memory_10_0.png" />
</div>
</div>
<p>We see that the network input has been constant throughout the simulation (<code class="docutils literal notranslate"><span class="pre">APPLE=1</span></code>). Notice that there might be some small similarity between the pattern <code class="docutils literal notranslate"><span class="pre">APPLE</span></code> and some other patterns. This is because the semantic pointers are not perfectly orthogonal and the dot product will amount to some value different from zero. This can be improved by increasing the dimensionality of vectors, yielding more orthogonal representations. At the output, the similarity of the represented semantic pointer
with the semantic pointer <code class="docutils literal notranslate"><span class="pre">APPLE</span></code> increases until it reaches the maximal value (<code class="docutils literal notranslate"><span class="pre">=1</span></code>). This means that the associative memory successfully retrieved the input pattern. The exponential increase is due to the synaptic filtering in <code class="docutils literal notranslate"><span class="pre">nengo.Probe</span></code>. This is used to show how the input to another group of neurons connected to the output of this particular AM module would look like.</p>
</div>
<div class="section" id="Step-2:-Clean-up-Memory">
<h2>Step 2: Clean-up Memory<a class="headerlink" href="#Step-2:-Clean-up-Memory" title="Permalink to this headline">¶</a></h2>
<p>In the next example, we show the ability of the associative memory to retrieve a clean pattern from a noisy input. This is a very common use of autoassociative memories, also called <em>clean-up</em> as the AM removes the noise in the input.</p>
<p>First, we construct a noisy semantic pointer to be cleaned up by using a combination of several semantic pointers. This is done by passing the expression <code class="docutils literal notranslate"><span class="pre">0.9*APPLE+0.5*CHERRY+0.4*APRICOT</span></code> as the input to the the network. The resulting input vector will still be mostly similar to one semantic pointer (<code class="docutils literal notranslate"><span class="pre">APPLE</span></code>) but is also somewhat similar to other semantic pointers in the vocabulary. Therefore, the task of the network will be to clean up the vector <code class="docutils literal notranslate"><span class="pre">APPLE</span></code>.</p>
<div class="section" id="Thresholding-Memory">
<h3>Thresholding Memory<a class="headerlink" href="#Thresholding-Memory" title="Permalink to this headline">¶</a></h3>
<p>One way to achieve this in SPA is by using the thresholding mechanism in the AM module. By specifying the threshold, the output will be similar only to those inputs whose similarity with a vocabulary item is above a certain value. In this example we will increase the selectivity of the AM by setting the threshold to to a higher value.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="s2">&quot;CleanupThreshold&quot;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">ThresholdingAssocMem</span><span class="p">(</span>
        <span class="n">threshold</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">input_vocab</span><span class="o">=</span><span class="n">vocab</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">vocab</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="p">(</span>
        <span class="mf">0.9</span> <span class="o">*</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">APPLE</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">CHERRY</span> <span class="o">+</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">APRICOT</span>
        <span class="o">&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span>
    <span class="p">)</span>

    <span class="n">input_probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
    <span class="n">output_probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>

<span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">plot_similarities</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">input_probe</span><span class="p">],</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">output_probe</span><span class="p">],</span> <span class="n">vocab</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_associative-memory_13_0.png" src="../_images/examples_associative-memory_13_0.png" />
</div>
</div>
<p>We see that the vector at the input is mostly similar to the semantic pointer <code class="docutils literal notranslate"><span class="pre">APPLE</span></code> and somewhat similar to the semantic pointer <code class="docutils literal notranslate"><span class="pre">CHERRY</span></code>. The vector at the output is very similar to the <code class="docutils literal notranslate"><span class="pre">APPLE</span></code>, indicating that the memory successfully cleaned up the noisy pattern.</p>
<p>However, the output of <code class="docutils literal notranslate"><span class="pre">APPLE</span></code> isn’t of similarity <code class="docutils literal notranslate"><span class="pre">1.0</span></code>. To achieve this, we can change the output mapping of the memory, so any output maps to maximum similarity, by making it computer the function <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">&gt;</span> <span class="pre">0</span></code> on all outputs <code class="docutils literal notranslate"><span class="pre">x</span></code>. This will produce a vector at the output which has similarity one with the semantic pointer <code class="docutils literal notranslate"><span class="pre">APPLE</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="s2">&quot;CleanupThreshold&quot;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">ThresholdingAssocMem</span><span class="p">(</span>
        <span class="n">threshold</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="n">input_vocab</span><span class="o">=</span><span class="n">vocab</span><span class="p">,</span>
        <span class="n">mapping</span><span class="o">=</span><span class="n">vocab</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
        <span class="n">function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="p">(</span>
        <span class="mf">0.9</span> <span class="o">*</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">APPLE</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">CHERRY</span> <span class="o">+</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">APRICOT</span>
        <span class="o">&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span>
    <span class="p">)</span>

    <span class="n">input_probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
    <span class="n">output_probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>

<span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">plot_similarities</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">input_probe</span><span class="p">],</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">output_probe</span><span class="p">],</span> <span class="n">vocab</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_associative-memory_15_0.png" src="../_images/examples_associative-memory_15_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="WTA-Memory">
<h2>WTA Memory<a class="headerlink" href="#WTA-Memory" title="Permalink to this headline">¶</a></h2>
<p>In some modelling scenarios we might have an input vector which is very similar to several other vectors in the vocabulary:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="s2">&quot;Cleanup&quot;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">ThresholdingAssocMem</span><span class="p">(</span>
        <span class="n">threshold</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">input_vocab</span><span class="o">=</span><span class="n">vocab</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">vocab</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="p">(</span>
        <span class="mf">0.9</span> <span class="o">*</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">APPLE</span> <span class="o">+</span> <span class="mf">0.85</span> <span class="o">*</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">CHERRY</span> <span class="o">+</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">APRICOT</span>
        <span class="o">&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span>
    <span class="p">)</span>

    <span class="n">input_probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
    <span class="n">output_probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>

<span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">plot_similarities</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">input_probe</span><span class="p">],</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">output_probe</span><span class="p">],</span> <span class="n">vocab</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_associative-memory_17_0.png" src="../_images/examples_associative-memory_17_0.png" />
</div>
</div>
<p>We see that the input is very similar to semantic pointers <code class="docutils literal notranslate"><span class="pre">APPLE</span></code> and <code class="docutils literal notranslate"><span class="pre">CHERRY</span></code>, and somewhat similar to <code class="docutils literal notranslate"><span class="pre">APRICOT</span></code>. In this situation, it might be difficult to determine a fixed threshold which will clean up the input and differentiate between the vectors <code class="docutils literal notranslate"><span class="pre">APPLE</span></code> and <code class="docutils literal notranslate"><span class="pre">CHERRY</span></code>. To ensure that only one vector at the output is similar to the strongest input, we can use <code class="docutils literal notranslate"><span class="pre">spa.WTAAssocMem</span></code> instead of <code class="docutils literal notranslate"><span class="pre">spa.ThresholdingAssocMem</span></code>. <code class="docutils literal notranslate"><span class="pre">WTA</span></code> is a computational principle called winner-take-all,
stating that one, mostly active element should be regarded as the winner among possible, less similar alternatives.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="s2">&quot;CleanupWTA&quot;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">WTAAssocMem</span><span class="p">(</span>
        <span class="n">threshold</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">input_vocab</span><span class="o">=</span><span class="n">vocab</span><span class="p">,</span>
        <span class="n">mapping</span><span class="o">=</span><span class="n">vocab</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
        <span class="n">function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="p">(</span>
        <span class="mf">0.9</span> <span class="o">*</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">APPLE</span> <span class="o">+</span> <span class="mf">0.85</span> <span class="o">*</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">CHERRY</span> <span class="o">+</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">spa</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">APRICOT</span>
        <span class="o">&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span>
    <span class="p">)</span>

    <span class="n">input_probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
    <span class="n">output_probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>

<span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">plot_similarities</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">input_probe</span><span class="p">],</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">output_probe</span><span class="p">],</span> <span class="n">vocab</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_associative-memory_19_0.png" src="../_images/examples_associative-memory_19_0.png" />
</div>
</div>
<p>Although the input vector is very similar to both <code class="docutils literal notranslate"><span class="pre">APPLE</span></code> and <code class="docutils literal notranslate"><span class="pre">CHERRY</span></code>, the memory manages to recover the <code class="docutils literal notranslate"><span class="pre">APPLE</span></code> at the output.</p>
</div>
<div class="section" id="Step-3:-Heteroassociative-relationships">
<h2>Step 3: Heteroassociative relationships<a class="headerlink" href="#Step-3:-Heteroassociative-relationships" title="Permalink to this headline">¶</a></h2>
<p>To model a variety of interesting memory phenomena, it is often useful to store relationships between different sets of patterns. For example, to simulate number counting from 1 to 5, the memory needs to store the relationships between patterns representing numbers: <span class="math notranslate nohighlight">\(1\rightarrow2,\ 2\rightarrow3,\ 3\rightarrow4,\ 4\rightarrow5\)</span></p>
<p>In this example we show how to use <code class="docutils literal notranslate"><span class="pre">spa.WTAAssocMem</span></code> for this task. In order to achieve the number counting, we will split the task into two parts:</p>
<ol class="arabic simple">
<li><p>Present a number at the input and recall a number greater by one (e.g. for <code class="docutils literal notranslate"><span class="pre">1</span></code> recall <code class="docutils literal notranslate"><span class="pre">2</span></code>, for <code class="docutils literal notranslate"><span class="pre">2</span></code> recall <code class="docutils literal notranslate"><span class="pre">3</span></code> etc.)</p></li>
<li><p>Feed the output of the associative memory back to its input</p></li>
</ol>
<p>As in the previous example, we start by defining a vocabulary that stores semantic pointers representing five numbers. This will be used as the input and as the output vocabulary. In case of hetero-associative memories the input and the output vocabulary can differ.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dim</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">vocab_numbers</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Vocabulary</span><span class="p">(</span><span class="n">dimensions</span><span class="o">=</span><span class="n">dim</span><span class="p">)</span>

<span class="n">vocab_numbers</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="s2">&quot;ONE; TWO; THREE; FOUR; FIVE&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now, in function <code class="docutils literal notranslate"><span class="pre">input_fun</span></code> we define which semantic pointer is going to be present at the input at certain simulation time. Because we want to achieve a heteroassociative mapping, we need to specify which input patterns map to which output patterns. The desired mapping is specified by providing the <code class="docutils literal notranslate"><span class="pre">mapping</span></code> argument when creating the AM module:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">input_fun</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;ONE&quot;</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">0.4</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;TWO&quot;</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">0.6</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;THREE&quot;</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">0.8</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;FOUR&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;0&quot;</span>


<span class="c1"># from patterns</span>
<span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;ONE&quot;</span><span class="p">:</span> <span class="s2">&quot;TWO&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TWO&quot;</span><span class="p">:</span> <span class="s2">&quot;THREE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;THREE&quot;</span><span class="p">:</span> <span class="s2">&quot;FOUR&quot;</span><span class="p">,</span>
    <span class="s2">&quot;FOUR&quot;</span><span class="p">:</span> <span class="s2">&quot;FIVE&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="s2">&quot;Counting&quot;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">WTAAssocMem</span><span class="p">(</span>
        <span class="n">threshold</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">input_vocab</span><span class="o">=</span><span class="n">vocab_numbers</span><span class="p">,</span>
        <span class="n">mapping</span><span class="o">=</span><span class="n">mapping</span><span class="p">,</span>
        <span class="n">function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">model</span><span class="o">.</span><span class="n">am_input</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Transcode</span><span class="p">(</span><span class="n">input_fun</span><span class="p">,</span> <span class="n">output_vocab</span><span class="o">=</span><span class="n">vocab_numbers</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">am_input</span> <span class="o">&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span>

    <span class="n">input_probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
    <span class="n">output_probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>

<span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

<span class="n">plot_similarities</span><span class="p">(</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">input_probe</span><span class="p">],</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">output_probe</span><span class="p">],</span>
    <span class="n">vocab_numbers</span><span class="p">,</span>
    <span class="n">autoscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_associative-memory_24_0.png" src="../_images/examples_associative-memory_24_0.png" />
</div>
</div>
<p>So far we have created a model which realises increments by one. The next step is to automatise this, so that when the model sees <code class="docutils literal notranslate"><span class="pre">ONE</span></code> it will produce <code class="docutils literal notranslate"><span class="pre">TWO,</span> <span class="pre">THREE,</span> <span class="pre">FOUR,</span> <span class="pre">FIVE</span></code>. To achieve counting, we need to introduce a feedback connection. That is, the network output needs to be fed into its input at the next time step. This can be easily done in Nengo by adding just one additional connection. Now, we initialise the simulation by presenting the semantic pointer <code class="docutils literal notranslate"><span class="pre">ONE</span></code> at the input for
the duration of 0.2 simulation time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">input_fun2</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;ONE&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;0&quot;</span>


<span class="k">with</span> <span class="n">spa</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="s2">&quot;Counting&quot;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">WTAAssocMem</span><span class="p">(</span>
        <span class="n">threshold</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">input_vocab</span><span class="o">=</span><span class="n">vocab_numbers</span><span class="p">,</span>
        <span class="n">output_vocab</span><span class="o">=</span><span class="n">vocab_numbers</span><span class="p">,</span>
        <span class="n">mapping</span><span class="o">=</span><span class="n">mapping</span><span class="p">,</span>
        <span class="n">function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">model</span><span class="o">.</span><span class="n">am_input</span> <span class="o">=</span> <span class="n">spa</span><span class="o">.</span><span class="n">Transcode</span><span class="p">(</span><span class="n">input_fun2</span><span class="p">,</span> <span class="n">output_vocab</span><span class="o">=</span><span class="n">vocab_numbers</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">am_input</span> <span class="o">&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span>

    <span class="c1"># added feedback connection</span>
    <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span>
        <span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.10</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="mf">3.5</span>
    <span class="p">)</span>

    <span class="n">input_probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
    <span class="n">output_probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">assoc_mem</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>

<span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

<span class="n">plot_similarities</span><span class="p">(</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">input_probe</span><span class="p">],</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">output_probe</span><span class="p">],</span>
    <span class="n">vocab_numbers</span><span class="p">,</span>
    <span class="n">autoscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_associative-memory_26_0.png" src="../_images/examples_associative-memory_26_0.png" />
</div>
</div>
<p>The only input our model receives is <code class="docutils literal notranslate"><span class="pre">ONE</span></code> at the beginning of the simulation. After that, it produces a sequence of consecutive numbers up to five. The connection parameters <code class="docutils literal notranslate"><span class="pre">synapse</span></code> and <code class="docutils literal notranslate"><span class="pre">transform</span></code> have been set to arbitrary values which produce the desired sequence. Try modifying them to see how they affect the behaviour.</p>
</div>
</div>


            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div><footer class="text-light footer-main gradient-bottom-center">
  <p class="text-center">
    <a class="no-hover-line" href="https://appliedbrainresearch.com">
      <img class="abr-logo" src="https://www.nengo.ai/img/abr-logo.svg" height="32" />
    </a>
    <a href="https://www.nengo.ai/">What is Nengo?</a>
    <a href="https://www.nengo.ai/examples/">Examples</a>
    <a href="https://www.nengo.ai/documentation/">Documentation</a>
    <a href="https://www.nengo.ai/getting-started/">Getting started</a>
    <a href="https://www.nengo.ai/privacy/">Privacy</a>
  </p>
  <p class="small text-center pb-0 mb-0">&copy; Applied Brain Research</p>
</footer>
<script>
  function switchVersion(select) {
    var option = select.selectedOptions[0];
    if (option.hasAttribute("value")) {
      window.location = option.value;
    }
  }
</script>

<script>
  var elements = document.querySelectorAll('.sidenav');
  Stickyfill.add(elements);
</script>
<script>
  ScrollReveal().reveal(".fade-in", {
      scale: 0.85,
      duration: 1000,
      delay: 250,
      interval: 50
  });
</script>
<script>
  $('a.toggle-sidenav').on('click', function(e) {
    e.preventDefault();
    if ( $(this).hasClass('active') ) {
      $(this).removeClass('active');
      $('.sidenav').removeClass('open');
    } else {
      $(this).addClass('active');
      $('.sidenav').addClass('open');
    }
  });
</script>
<script>
  var lists = document.querySelectorAll('.toctree ul');
  lists.forEach((ul) => {
      ul.classList.add("nav");
  });
  var links = document.querySelectorAll('.toctree a');
  links.forEach((link) => {
      link.classList.add("nav-link");
  });
  $("body").scrollspy({target: ".sidenav"});
</script>
  </body>
</html>